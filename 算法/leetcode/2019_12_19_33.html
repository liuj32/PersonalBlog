<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <script src="./node.js"></script>
  <script>
var search = function(nums, target) {
    if(nums.length == 0){
        return -1;
    }
    if(nums.length == 1){
        return  nums[0] == target ?  0 : -1;
    }
    var mix = find_rotate_index(nums, 0, nums.length -1)
    if(mix == 0)
      return  binaySearch(nums, 0, nums.length -1, target)    
    if(nums[0] > target)
      return  binaySearch(nums, rotate_index, nums.length -1, target)
    return  binaySearch(nums, 0, mix, target)
};

function binaySearch (arr, left, right, target){
    while(left <= right){
        var mid = Math.floor((left + right) /2);
        if(arr[mid] == target){
          return mid;
        }        
        if(target < arr[mid]) {
           right = mid -1;
        }else { 
           left = mid +1
        }       
    }
    return -1
}


  function find_rotate_index(arr, left, right){
    if (arr[left] < arr[right])
      return 0;
    while(left <= right){
      var mid = Math.floor((left + right)/2)
      if(arr[mid] > arr[mid+1]){
        return mid+1;
      } else {
        if(arr[mid] < arr[left]) {
          right = mid -1;
        } else{
          left = mid +1;
        }
      }
    }
    return 0
  }

console.log(  search( [1,3], 3)    )
  </script>
</body>
</html>